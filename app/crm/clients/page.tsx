import { Client as PG } from 'pg';async function loadClients(){const url = process.env.DATABASE_URL; if(!url)return{ok:false,error:'DATABASE_URL missing',rows:[]};const db=new PG({connectionString:url,ssl:{rejectUnauthorized:false}});try{await db.connect();const r=await db.query(`select id, name, email, vat, city, country, payment_term_days, created_at from clients order by created_at desc limit 100`);await db.end();return{ok:true,rows:r.rows};}catch(e:any){return{ok:false,error:e.message,rows:[]};}}export default async function Page(){const data=await loadClients();return(<main style={{padding:'32px'}}><h1>Klanten (CRM)</h1>{!data.ok && (<div style={{color:'#b91c1c', marginTop:8}}>Kan niet laden: {data.error}.<br/>Tip: voer de SQL-migraties uit om de tabel <code>clients</code> aan te maken.</div>)}{data.ok && (<div style={{overflowX:'auto', marginTop:16}}><table style={{width:'100%', borderCollapse:'collapse'}}><thead><tr><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>Naam</th><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>Eâ€‘mail</th><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>BTW</th><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>Plaats</th><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>Land</th><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>Betaaltermijn</th><th style={{textAlign:'left', padding:8, borderBottom:'1px solid #e5e7eb'}}>Aangemaakt</th></tr></thead><tbody>{data.rows.map((c:any)=>(<tr key={c.id}><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{c.name}</td><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{c.email||'-'}</td><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{c.vat||'-'}</td><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{c.city||'-'}</td><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{c.country||'-'}</td><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{c.payment_term_days}</td><td style={{padding:8, borderBottom:'1px solid #f1f5f9'}}>{new Date(c.created_at).toLocaleString()}</td></tr>))}</tbody></table></div>)}</main>);}